<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XENSIV BGT60TRxx Radar Sensor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XENSIV BGT60TRxx Radar Sensor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">XENSIV™ BGT60TRxx radar sensor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This library provides functions for interfacing with the XENSIV™ BGT60TRxx 60 GHz FMCW Radar Sensors. This library can be set up to use the ModusToolbox&trade; HAL interface, or using user-provided communication functions. For more information about the XENSIV™ Radar Sensor please visit the <a href="https://www.infineon.com/cms/en/product/sensor/radar-sensors/radar-sensors-for-iot/60ghz-radar/">Infineon web page on radar sensors</a>.</p>
<h2>Quick start</h2>
<p>For the hardware setup, see the <a href="https://www.infineon.com/cms/en/product/promopages/connectedsensorkit/">Radar Wingboard user guide</a>.</p>
<p>The initialization of the XENSIV™ BGT60TRxx radar sensor requires a list of registers that can be generated using the bgt60-configurator-cli tool.</p>
<p>The bgt60-configurator-cli is available through the <a href="https://softwaretools.infineon.com/welcome">Infineon Developer Center</a>.</p>
<p>The bgt60-configurator-cli tool takes as input a configuration file in JSON format specifying the radar parameters: </p><pre class="fragment">{
    "device_config": {
        "fmcw_single_shape": {
            "rx_antennas": [1], 
            "tx_antennas": [1], 
            "tx_power_level": 31, 
            "if_gain_dB": 60, 
            "lower_frequency_Hz": 61020098000, 
            "upper_frequency_Hz": 61479902000, 
            "num_chirps_per_frame": 1, 
            "num_samples_per_chirp": 128, 
            "chirp_repetition_time_s": 7e-05, 
            "frame_repetition_time_s": 5e-3, 
            "sample_rate_Hz": 2330000
        }
    }
}
</pre><p>Save the configuration as presence_radar_settings.json. To generate the register file:</p>
<div class="fragment"><div class="line">./bgt60-configurator-cli -c presence_radar_settings.json -o presence_radar_settings.h</div></div><!-- fragment --><p><b>Note:</b> For the functionality of the following example, ADC channel 1 must be active because the data test mode works only on this channel. See the <code>rx_antennas</code> item in the configuration file.</p>
<p>Follow the steps below to create a simple application that checks basic functionality and connectivity to the radar sensor. The application configures the sensor, enable the test mode, starts the frame generation and checks the data obtained from the radar sensor on antenna RX1 against a defined bit sequence.</p>
<ol type="1">
<li>Create an empty ModusToolbox application for your board.</li>
<li>Add this library, i.e. sensor-xensiv-bgt60trxx, to the application using the Library Manager.</li>
<li>Add the retarget-io library using the Library Manager.</li>
<li>Define the following as as appropriate for your hardware/kit configuration:<ul>
<li><code>PIN_XENSIV_BGT60TRXX_SPI_SCLK</code></li>
<li><code>PIN_XENSIV_BGT60TRXX_SPI_MOSI</code></li>
<li><code>PIN_XENSIV_BGT60TRXX_SPI_MISO</code></li>
<li><code>PIN_XENSIV_BGT60TRXX_SPI_CSN</code></li>
<li><code>PIN_XENSIV_BGT60TRXX_IRQ</code></li>
<li><code>PIN_XENSIV_BGT60TRXX_RSTN</code></li>
<li><p class="startli"><code>PIN_XENSIV_BGT60TRXX_LDO_EN</code></p>
<p class="startli"><b>Note:</b> The pins in the code example below correspond to the ones used in CYBSYSKIT-DEV-01 kit</p>
</li>
</ul>
</li>
<li>Place the following code in the <em>main.c</em> file.</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;cyhal.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;cybsp.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;cy_retarget_io.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;xensiv_bgt60trxx_mtb.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define XENSIV_BGT60TRXX_CONF_IMPL</span></div><div class="line"><span class="preprocessor">#include &quot;presence_radar_settings.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">/*******************************************************************************</span></div><div class="line"><span class="comment">* Macros</span></div><div class="line"><span class="comment">*******************************************************************************/</span></div><div class="line"><span class="comment">/* sensor SPI interface */</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_SPI_SCLK       CYBSP_SPI_CLK</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_SPI_MOSI       CYBSP_SPI_MOSI</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_SPI_MISO       CYBSP_SPI_MISO</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_SPI_CSN        CYBSP_SPI_CS</span></div><div class="line"></div><div class="line"><span class="comment">/* sensor interrupt output pin */</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_IRQ            CYBSP_GPIO10</span></div><div class="line"><span class="comment">/* sensor HW reset pin */</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_RSTN           CYBSP_GPIO11</span></div><div class="line"></div><div class="line"><span class="comment">/* enable 1V8 LDO */</span></div><div class="line"><span class="preprocessor">#define PIN_XENSIV_BGT60TRXX_LDO_EN         CYBSP_GPIO5</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define XENSIV_BGT60TRXX_SPI_FREQUENCY      (25000000UL)</span></div><div class="line"></div><div class="line"><span class="comment">/*******************************************************************************</span></div><div class="line"><span class="comment">* Global variables</span></div><div class="line"><span class="comment">*******************************************************************************/</span></div><div class="line"><span class="keyword">static</span> cyhal_spi_t cyhal_spi;</div><div class="line"><span class="keyword">static</span> <a class="code" href="group__group__board__libs__mtb.html#structxensiv__bgt60trxx__mtb__t">xensiv_bgt60trxx_mtb_t</a> xensiv_bgt60trxx;</div><div class="line"><span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span> data_available = <span class="keyword">false</span>;</div><div class="line"></div><div class="line"><span class="comment">/* Allocate enough memory for the radar dara frame. */</span></div><div class="line"><span class="keyword">static</span> uint8_t data_buffer[XENSIV_BGT60TRXX_CONF_BUFFER_SIZE_BYTES];</div><div class="line"></div><div class="line"><span class="comment">/* Interrupt handler to react on sensor indicating the availability of new data */</span></div><div class="line"><span class="keywordtype">void</span> xensiv_bgt60trxx_mtb_interrupt_handler(<span class="keywordtype">void</span> *args, cyhal_gpio_irq_event_t event)</div><div class="line">{</div><div class="line">    CY_UNUSED_PARAMETER(args);</div><div class="line">    CY_UNUSED_PARAMETER(event);</div><div class="line">    data_available = <span class="keyword">true</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    cy_rslt_t result = CY_RSLT_SUCCESS;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the device and board peripherals. */</span></div><div class="line">    result = cybsp_init();</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    __enable_irq();</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize retarget-io to use the debug UART port. */</span></div><div class="line">    result = cy_retarget_io_init(CYBSP_DEBUG_UART_TX, CYBSP_DEBUG_UART_RX, CY_RETARGET_IO_BAUDRATE);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;XENSIV BGT60TRxx Example\r\n&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the SPI interface to BGT60. */</span></div><div class="line">    result = cyhal_spi_init(&amp;cyhal_spi,</div><div class="line">                            PIN_XENSIV_BGT60TRXX_SPI_MOSI,</div><div class="line">                            PIN_XENSIV_BGT60TRXX_SPI_MISO,</div><div class="line">                            PIN_XENSIV_BGT60TRXX_SPI_SCLK,</div><div class="line">                            NC,</div><div class="line">                            NULL,</div><div class="line">                            8,</div><div class="line">                            CYHAL_SPI_MODE_00_MSB,</div><div class="line">                            <span class="keyword">false</span>);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    <span class="comment">/* Reduce drive strength to improve EMI */</span></div><div class="line">    Cy_GPIO_SetSlewRate(CYHAL_GET_PORTADDR(PIN_XENSIV_BGT60TRXX_SPI_MOSI),</div><div class="line">                        CYHAL_GET_PIN(PIN_XENSIV_BGT60TRXX_SPI_MOSI), CY_GPIO_SLEW_FAST);</div><div class="line">    Cy_GPIO_SetDriveSel(CYHAL_GET_PORTADDR(PIN_XENSIV_BGT60TRXX_SPI_MOSI),</div><div class="line">                        CYHAL_GET_PIN(PIN_XENSIV_BGT60TRXX_SPI_MOSI), CY_GPIO_DRIVE_1_8);</div><div class="line">    Cy_GPIO_SetSlewRate(CYHAL_GET_PORTADDR(PIN_XENSIV_BGT60TRXX_SPI_SCLK),</div><div class="line">                        CYHAL_GET_PIN(PIN_XENSIV_BGT60TRXX_SPI_SCLK), CY_GPIO_SLEW_FAST);</div><div class="line">    Cy_GPIO_SetDriveSel(CYHAL_GET_PORTADDR(PIN_XENSIV_BGT60TRXX_SPI_SCLK),</div><div class="line">                        CYHAL_GET_PIN(PIN_XENSIV_BGT60TRXX_SPI_SCLK), CY_GPIO_DRIVE_1_8);</div><div class="line"></div><div class="line">    <span class="comment">/* Set the data rate to 25 Mbps */</span></div><div class="line">    result = cyhal_spi_set_frequency(&amp;cyhal_spi, XENSIV_BGT60TRXX_SPI_FREQUENCY);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    <span class="comment">/* Enable the LDO. */</span></div><div class="line">    result = cyhal_gpio_init(PIN_XENSIV_BGT60TRXX_LDO_EN,</div><div class="line">                             CYHAL_GPIO_DIR_OUTPUT,</div><div class="line">                             CYHAL_GPIO_DRIVE_STRONG,</div><div class="line">                             <span class="keyword">true</span>);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    <span class="comment">/* Wait LDO stable */</span></div><div class="line">    (void)cyhal_system_delay_ms(5);</div><div class="line"></div><div class="line">    result = <a class="code" href="group__group__board__libs__mtb.html#ga19e46321b5d98f7d9b86180c7941b074">xensiv_bgt60trxx_mtb_init</a>(&amp;xensiv_bgt60trxx,</div><div class="line">                                       &amp;cyhal_spi,</div><div class="line">                                       PIN_XENSIV_BGT60TRXX_SPI_CSN,</div><div class="line">                                       PIN_XENSIV_BGT60TRXX_RSTN,</div><div class="line">                                       register_list,</div><div class="line">                                       XENSIV_BGT60TRXX_CONF_NUM_REGS);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize interrupt generation */</span></div><div class="line">    <a class="code" href="group__group__board__libs__mtb.html#structxensiv__bgt60trxx__mtb__interrupt__cb__t">xensiv_bgt60trxx_mtb_interrupt_cb_t</a> interrupt_cb =</div><div class="line">    {</div><div class="line">        .<a class="code" href="group__group__board__libs__mtb.html#a09f80072f1413234838995d4d1f47b5d">callback</a>     = xensiv_bgt60trxx_mtb_interrupt_handler,</div><div class="line">        .callback_arg = NULL</div><div class="line">    };</div><div class="line"></div><div class="line">    <span class="comment">/* The sensor will generate an interrupt once the sensor FIFO level is</span></div><div class="line"><span class="comment">       XENSIV_BGT60TRXX_CONF_FRAME_XFER_SIZE_WORDS */</span></div><div class="line">    result = <a class="code" href="group__group__board__libs__mtb.html#gab422b3a92164f16536dee6779b528842">xensiv_bgt60trxx_mtb_interrupt_init</a>(&amp;xensiv_bgt60trxx,</div><div class="line">                                                 XENSIV_BGT60TRXX_CONF_FRAME_XFER_SIZE_WORDS,</div><div class="line">                                                 PIN_XENSIV_BGT60TRXX_IRQ,</div><div class="line">                                                 CYHAL_ISR_PRIORITY_DEFAULT,</div><div class="line">                                                 &amp;interrupt_cb);</div><div class="line">    CY_ASSERT(result == CY_RSLT_SUCCESS);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__board__libs.html#ga267a2b5114bf42df2da435506c5cc379">xensiv_bgt60trxx_enable_data_test_mode</a>(&amp;xensiv_bgt60trxx, <span class="keyword">true</span>) != <a class="code" href="group__group__board__libs.html#ga754adc18368d63b331a2c9cbeff0f763">XENSIV_BGT60TRXX_STATUS_OK</a>)</div><div class="line">    {</div><div class="line">        CY_ASSERT(0);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__group__board__libs.html#gae4bf5c3c01bc7a8c5021c0e05c51346f">xensiv_bgt60trxx_start_frame</a>(&amp;xensiv_bgt60trxx, <span class="keyword">true</span>) != <a class="code" href="group__group__board__libs.html#ga754adc18368d63b331a2c9cbeff0f763">XENSIV_BGT60TRXX_STATUS_OK</a>)</div><div class="line">    {</div><div class="line">        CY_ASSERT(0);</div><div class="line">    }</div><div class="line"></div><div class="line">    uint32_t frame_idx = 0;</div><div class="line">    uint16_t test_word = <a class="code" href="group__group__board__libs.html#ga5d329c284c5ba4b01d7bb252c6e908b7">XENSIV_BGT60TRXX_INITIAL_TEST_WORD</a>;</div><div class="line">    <span class="keyword">const</span> int32_t num_rx_antennas = XENSIV_BGT60TRXX_CONF_NUM_RX_ANTENNAS;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span>(;;)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Wait for the radar device to indicate the availability of the data to fetch. */</span></div><div class="line">        <span class="keywordflow">while</span> (data_available == <span class="keyword">false</span>);</div><div class="line">        data_available = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__group__board__libs.html#ga641c6511639c49fe9a90cd3635ebdf50">xensiv_bgt60trxx_get_fifo_data</a>(&amp;xensiv_bgt60trxx, data_buffer, </div><div class="line">                                           XENSIV_BGT60TRXX_CONF_FRAME_XFER_SIZE_WORDS) == 0)</div><div class="line">        {</div><div class="line">            <span class="keyword">const</span> uint8_t * buffer_ptr = data_buffer;</div><div class="line"></div><div class="line">            <span class="comment">/* Payload begins after the 32-bit buffer header. */</span></div><div class="line">            buffer_ptr += <a class="code" href="group__group__board__libs.html#ga07f122de15b23fc7f6cf7294787bb732">XENSIV_BGT60TRXX_SPI_BURST_HEADER_SIZE_BYTES</a>;</div><div class="line"></div><div class="line">            <span class="comment">/* Unpack the data and check the received data against the expected sequence. */</span></div><div class="line">            <span class="keywordflow">for</span> (int32_t i = 0; i &lt; XENSIV_BGT60TRXX_CONF_FRAME_XFER_SIZE_WORDS; ++i)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (num_rx_antennas == 1)</div><div class="line">                {</div><div class="line">                    uint16_t sample_0 = ((uint16_t)buffer_ptr[0] &lt;&lt; 4) +</div><div class="line">                                        ((buffer_ptr[1] &amp; (uint8_t)0xf0U) &gt;&gt; 4);</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (test_word != sample_0)</div><div class="line">                    {</div><div class="line">                        printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                               frame_idx, test_word, sample_0);</div><div class="line">                        CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="comment">// Generate the next test_word.</span></div><div class="line">                    test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line"></div><div class="line">                    uint16_t sample_1 = (((uint16_t)buffer_ptr[1] &amp; (uint8_t)0x0fU) &lt;&lt; 8) +</div><div class="line">                                        buffer_ptr[2];</div><div class="line">                    <span class="keywordflow">if</span> (test_word != sample_1)</div><div class="line">                    {</div><div class="line">                        printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                               frame_idx, test_word, sample_1);</div><div class="line">                        CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="comment">// Generate the next test_word.</span></div><div class="line">                    test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line"></div><div class="line">                    buffer_ptr += <a class="code" href="group__group__board__libs.html#gafa7d5ebdb836b9d629acf94c22e2df4c">XENSIV_BGT60TRXX_FIFO_WORD_SIZE_BYTES</a>;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (num_rx_antennas == 2)</div><div class="line">                {</div><div class="line">                    uint16_t sample = ((uint16_t)buffer_ptr[0] &lt;&lt; 4) +</div><div class="line">                                      ((buffer_ptr[1] &amp; (uint8_t)0xf0U) &gt;&gt; 4);</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (test_word != sample)</div><div class="line">                    {</div><div class="line">                        printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                               <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                               frame_idx, test_word, sample);</div><div class="line">                        CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="comment">// Generate the next test_word.</span></div><div class="line">                    test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line">                    buffer_ptr += <a class="code" href="group__group__board__libs.html#gafa7d5ebdb836b9d629acf94c22e2df4c">XENSIV_BGT60TRXX_FIFO_WORD_SIZE_BYTES</a>;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (num_rx_antennas == 3)</div><div class="line">                {</div><div class="line">                    <span class="keyword">static</span> <span class="keywordtype">int</span> j = 0;</div><div class="line">                    <span class="keywordflow">if</span> (j == 0)</div><div class="line">                    {</div><div class="line">                        uint16_t sample_0 = ((uint16_t)buffer_ptr[0] &lt;&lt; 4) +</div><div class="line">                                            ((buffer_ptr[1] &amp; (uint8_t)0xf0U) &gt;&gt; 4);</div><div class="line"></div><div class="line">                        <span class="keywordflow">if</span> (test_word != sample_0)</div><div class="line">                        {</div><div class="line">                            printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                                   frame_idx, test_word, sample_0);</div><div class="line">                            CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                        }</div><div class="line">                        j++;</div><div class="line"></div><div class="line">                        <span class="comment">// Generate the next test_word.</span></div><div class="line">                        test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (j == 1)</div><div class="line">                    {</div><div class="line">                        uint16_t sample_1 = (((uint16_t)buffer_ptr[1] &amp; (uint8_t)0x0fU) &lt;&lt; 8) +</div><div class="line">                                            buffer_ptr[2];</div><div class="line">                        <span class="keywordflow">if</span> (test_word != sample_1)</div><div class="line">                        {</div><div class="line">                            printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                                   frame_idx, test_word, sample_1);</div><div class="line">                            CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                        }</div><div class="line">                        j++;</div><div class="line"></div><div class="line">                        <span class="comment">// Generate the next test_word.</span></div><div class="line">                        test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (j == 2)</div><div class="line">                    {</div><div class="line">                        j = 0;</div><div class="line">                    }</div><div class="line"></div><div class="line">                    buffer_ptr += <a class="code" href="group__group__board__libs.html#gafa7d5ebdb836b9d629acf94c22e2df4c">XENSIV_BGT60TRXX_FIFO_WORD_SIZE_BYTES</a>;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (num_rx_antennas == 4)</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> ((i &amp; 0x1) == 0)</div><div class="line">                    {</div><div class="line">                        uint16_t sample_0 = ((uint16_t)buffer_ptr[0] &lt;&lt; 4) +</div><div class="line">                                            ((buffer_ptr[1] &amp; (uint8_t)0xf0U) &gt;&gt; 4);</div><div class="line"></div><div class="line">                        <span class="keywordflow">if</span> (test_word != sample_0)</div><div class="line">                        {</div><div class="line">                            printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; error detected. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Expected: %&quot;</span> PRIu16 <span class="stringliteral">&quot;. &quot;</span></div><div class="line">                                   <span class="stringliteral">&quot;Received: %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line">                                   frame_idx, test_word, sample_0);</div><div class="line">                            CY_ASSERT(<span class="keyword">false</span>);</div><div class="line">                        }</div><div class="line"></div><div class="line">                        <span class="comment">// Generate the next test_word.</span></div><div class="line">                        test_word = <a class="code" href="group__group__board__libs.html#gafbe627c4a4096fc1e94328acf06bafa0">xensiv_bgt60trxx_get_next_test_word</a>(test_word);</div><div class="line">                    }</div><div class="line">                    buffer_ptr += <a class="code" href="group__group__board__libs.html#gafa7d5ebdb836b9d629acf94c22e2df4c">XENSIV_BGT60TRXX_FIFO_WORD_SIZE_BYTES</a>;</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Frame %&quot;</span> PRIu32 <span class="stringliteral">&quot; received correctly\n&quot;</span>, frame_idx);</div><div class="line">        frame_idx++;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><ol type="1">
<li>Connect the board to your PC using the provided USB cable through the KitProg3 USB connector.</li>
<li>Open a terminal program and select the KitProg3 COM port. Set the serial port parameters to 8N1 and 115200 baud.</li>
<li><p class="startli">Build the application and program the kit. After programming, the application starts automatically.</p>
<p class="startli"><b>Figure 1. Terminal output on program startup</b></p>
<div class="image">
<img src="example-terminal.png" alt="example-terminal.png"/>
</div>
</li>
</ol>
<h2>Using the library for your own platform</h2>
<p>The library can be used in your own platform by copying the following files to your project:</p><ul>
<li><em>xensiv_bgt60trxx.c</em></li>
<li><em>xensiv_bgt60trxx.h</em></li>
<li><em>xensiv_bgt60trxx_platform.h</em></li>
<li><em>xensiv_bgt60trxx_regs.h</em></li>
</ul>
<p>The library depends on a platform-specific implementation of the following functions:</p>
<div class="fragment"><div class="line">int32_t <a class="code" href="group__group__board__libs__platform.html#ga07e4b7f7bcf7d66905426bc71297c8c4">xensiv_bgt60trxx_platform_spi_transfer</a>(<span class="keywordtype">void</span> * ctx, <span class="keyword">const</span> uint8_t * tx_data, uint32_t tx_len, uint8_t * rx_data, uint32_t rx_len);</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__group__board__libs__platform.html#gab4e728718b61bd8017a3e1906cfe2999">xensiv_bgt60trxx_platform_delay</a>(uint32_t ms);</div><div class="line">uint32_t <a class="code" href="group__group__board__libs__platform.html#ga3a005f9b458ca5a5a7eb4b752ecc61e3">xensiv_bgt60trxx_platform_word_reverse</a>(uint32_t x);</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__group__board__libs__platform.html#ga810dbed1b39c06c645c5d5df51e00997">xensiv_bgt60trxx_platform_assert</a>(<span class="keywordtype">int</span> expr);</div></div><!-- fragment --><p> See the example implementation for the platform-specific functions in <em>xensiv_bgt60trxx_mtb.c</em> using the PSoC™ 6 HAL.</p>
<h2>More information</h2>
<ul>
<li><a href="https://infineon.github.io/sensor-xensiv-bgt60trxx/html/index.html">API reference guide</a></li>
<li><a href="https://www.infineon.com">Infineon Technologies</a></li>
<li><a href="https://github.com/infineon">Infineon GitHub</a></li>
<li><a href="https://www.cypress.com/products/modustoolbox-software-environment">ModusToolbox™</a></li>
<li><a href="https://github.com/infineon/Code-Examples-for-ModusToolbox-Software">PSoC™ 6 code examples using ModusToolbox™</a></li>
<li><a href="https://github.com/Infineon/modustoolbox-software">ModusToolbox™ software</a></li>
<li><a href="https://community.cypress.com/docs/DOC-14644">PSoC™ 6 MCU resources - KBA223067</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>XENSIV BGT60TRxx Radar Sensor</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
